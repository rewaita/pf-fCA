<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>7 before me - Game | Rewaita Portfolio</title>
    <link rel="stylesheet" href="wPstyle.css">
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Noto+Sans+JP:wght@300;400;500;700&display=swap" rel="stylesheet">
</head>
<body>
    <nav class="fixed-nav" id="fixedNav">
        <div class="nav-inner">
            <a href="../index.html" class="nav-logo">PORTFOLIO</a>
            <ul class="nav-links">
                <li><a href="../index.html">HOME</a></li>
                <li><a href="../index.html#game">GAME</a></li>
                <li><a href="../index.html#graphic">GRAPHIC</a></li>
                <li><a href="../index.html#music">MUSIC</a></li>
                <li><a href="../index.html#other">OTHER</a></li>
            </ul>
            <div class="nav-hamburger" id="navHamburger">
                <span></span><span></span><span></span>
            </div>
        </div>
    </nav>
    <div class="image-popup-overlay" id="imagePopup">
        <button class="popup-close" id="popupClose">&times;</button>
        <img src="" alt="Popup Image" class="popup-image" id="popupImage">
        <div class="popup-nav">
            <button class="popup-prev" id="popupPrev">&lt;</button>
            <button class="popup-next" id="popupNext">&gt;</button>
        </div>
    </div>

    <main class="work-container">
        <div class="hero-section">
            <div class="hero-bg">
                <img src="../game/s7BeforeMe/7bmTitlee.png" alt="Thumbnail">
            </div>
            <div class="hero-overlay"></div>
            <div class="hero-content">
                <span class="hero-category">GAME</span>
                <h1 class="hero-title">7 before Me</h1>
                <p class="hero-catch">AIをクリアさせるために上手く学習データを作るゲーム</p>
            </div>
        </div>
        
        <section class="info">
            <div class="info-inner">
                <h2 class="section-label">CONCEPT</h2>
                <p class="concept">
                    鏡に隔てられた世界で、あなたは鏡に写った像です。<br>
                    7回のデモプレイを通じて、AIにステージの攻略方法を学習させ、最終的にAIが自動でパズルをクリアすることを目指します。<br>
                </p>
            </div>
        </section>

        <section class="slider-container">
            <h2 class="gallery-title">GALLERY</h2>
            <button class="leftB"><span>&lt;</span></button>
            <div class="slider-wrapper">
                <img src="../game/s7BeforeMe/7bmTitlee.png" class="slide" alt="タイトル画面" data-index="0">
                <img src="../game/s7BeforeMe/starts2.png" class="slide" alt="世界観概要" data-index="1">
                <img src="../game/s7BeforeMe/slides1.png" class="slide" alt="コンセプト概要" data-index="2">
                <img src="../game/s7BeforeMe/slides2.png" class="slide" alt="ゲーム概要" data-index="3">
                <img src="../game/s7BeforeMe/slides3.png" class="slide" alt="AI紹介" data-index="4">
                <img src="../game/s7BeforeMe/gimics.png" class="slide" alt="ギミック紹介" data-index="5">
                <img src="../game/s7BeforeMe/games1.png" class="slide" alt="ゲーム画面1" data-index="6">
                <img src="../game/s7BeforeMe/games2.png" class="slide" alt="ゲーム画面2" data-index="7">
                <img src="../game/s7BeforeMe/games3.png" class="slide" alt="ゲーム画面3" data-index="8">
                <img src="../game/s7BeforeMe/games4.png" class="slide" alt="ゲーム画面4" data-index="9">
                <img src="../game/s7BeforeMe/games5.png" class="slide" alt="ゲーム画面5" data-index="10">
            </div>
            <button class="rightB"><span>&gt;</span></button>
            <p class="gallery-hint">クリックで拡大表示</p>
        </section>

        <section class="tech">
            <div class="tech-inner">
                <h2 class="section-label">DEVELOPMENT</h2>
                <p class="tech-memo">
                授業課題にて作成。AIの仕組みをゲームとして体験できるようにすることを目的とし、
                また、私自身のAIに対する理解度向上、及びunity6.2という最新バージョンでの開発経験を積むことを
                目的として制作しました。<br>
                このゲームはプレイヤーが7回のデモプレイを行い、その行動ログをもとにAIが学習を行い、
                最終的にAIがステージをクリアできるかシミュレーションするという流れで進行します。<br>
                AIは学習アルゴリズムには行動クローニングと決定木を利用し、
                7回のデモプレイを通じてAIがプレイヤーの行動を模倣します。<br>
                プレイヤーは複数回のゲームプレイを通して、どんな行動がAIの学習に効果的かを考えながら、
                まるでパズルのギミックを解くようにAIがステージをクリアできるように学習データを作成していきます。
                この流れで自然にAIの学習プロセスを体験できるようになっています。<br>
                ステージは、AIの視界を再現するように、プレイヤーの通った場所しか表示されない仕様であったり、
                データに多様性を持たせるために複数回同じマスを通ると罰が与えられるようになる仕様、トラップを踏むと
                ランダムな方向に飛ばされてログが乱れてしまう仕様などを実装し、デモプレイを繰り返すというプレイ体験が
                単純な作業にならないよう工夫しました。
                </p>
                <div class="tech-specs">
                    <div class="tech-item">
                        <div class="tech-detail">
                            <span class="tech-label">ツール</span>
                            <span class="tech-value">Unity</span>
                        </div>
                    </div>
                    <div class="tech-item">
                        <div class="tech-detail">
                            <span class="tech-label">使用言語</span>
                            <span class="tech-value">C#  python</span>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <section class="workflow">
            <h2 class="section-label light">GAME FLOW</h2>
            <div class="workflow-container">
                <div class="wf-track">
                    <div class="wf-branch">
                    <div class="wf-step">
                        <div class="step-content">
                            <span class="step-label">タイトル</span>
                        </div>
                        <div class="wf-popup">
                            <img src="../game/s7BeforeMe/starts1.png" alt="title screen">
                            <h4>タイトル画面</h4>
                            <p>ゲームの開始画面。ボタンをクリックで選択します。</p>
                        </div>
                    </div>
                    </div>
                    
                    <div class="wf-arrow"></div>

                    <div class="wf-branch">
                        <div class="wf-step">
                            <div class="step-content">
                                <span class="step-label">ストーリー概要</span>
                            </div>
                            <div class="wf-popup">
                                <img src="../game/s7BeforeMe/starts2.png" alt="Select difficulty">
                                <h4>ストーリー概要</h4>
                                <p>ストーリーを説明する画像が表示されます。下のボタンで別のメニューに飛ぶことができます</p>
                            </div>
                        </div>
                        <div class="wf-step">
                            <div class="step-content">
                                <span class="step-label">ゲームスタート</span>
                            </div>
                            <div class="wf-popup">
                                <img src="../game/s7BeforeMe/games1.png" alt="Select difficulty">
                                <h4>ゲームスタート</h4>
                                <p>そのままゲームをスタートします。WASDで移動し、デモプレイの行動を記録します。</p>
                            </div>
                        </div>
                        <div class="wf-step">
                            <div class="step-content">
                                <span class="step-label">ゲームルール説明</span>
                            </div>
                            <div class="wf-popup">
                                <img src="../game/s7BeforeMe/starts3.png" alt="Select difficulty">
                                <h4>ゲームルール説明</h4>
                                <p>ルールについて説明があります。主にAIの学習方法についての詳細を知ることができます。下のボタンで別のメニューに飛ぶことができます</p>
                            </div>
                        </div>
                    </div>

                    <div class="wf-arrow"></div>

                    <div class="wf-branch">
                    <div class="wf-step">
                        <div class="step-content">
                            <span class="step-label">デモプレイ x7</span>                
                        </div>
                        <div class="wf-popup">
                            <img src="../game/s7BeforeMe/games3.png" alt="Result">
                            <h4>デモプレイ x7</h4>
                            <p>プレイヤーの操作でデモプレイを7回行います。デモプレイは穴に落ちて失敗するか、ゴールに辿り着くかで終了し、行動ログがAIの学習データとして保存されます。<br>
                                回数を重ねるにつれ、鏡にはヒビが入っていきます。
                            </p>
                        </div>
                    </div>
                    </div>

                    <div class="wf-arrow"></div>

                    <div class="wf-branch">
                    <div class="wf-step">
                        <div class="step-content">
                            <span class="step-label">AI学習</span>                
                        </div>
                        <div class="wf-popup">
                            <img src="../game/s7BeforeMe/moveStageP.png" alt="Result">
                            <h4>AI学習</h4>
                            <p>7回のデモプレイで出力されたログをもとに、AIが学習を行います。プレイヤーはAIに攻略方法を学習させるのが目的なので必ずしもゴールに辿り着く必要はなく、穴に落ちて失敗しても直接的なペナルティはありません。<br>

                            </p>
                        </div>
                    </div>
                    </div>

                    <div class="wf-arrow"></div>

                    <div class="wf-branch">
                    <div class="wf-step">
                        <div class="step-content">
                            <span class="step-label">AIシミュレーション</span>
                        </div>
                        <div class="wf-popup">
                            <img src="../game/s7BeforeMe/games5.png" alt="moveStage">
                            <h4>AIシミュレーション</h4>
                            <p>学習したAIが、実際にステージをクリアできるかシミュレーションを行います。学習が不十分な場合、AIはステージをクリアできずに穴に落ちたり、時間切れで消滅したりします。
                            </p>
                        </div>
                    </div>
                    </div>

                    <div class="wf-arrow"></div>

                    <div class="wf-branch">
                        <div class="wf-step">
                            <div class="step-content">
                                <span class="step-label">クリア</span>
                                
                            </div>
                            <div class="wf-popup">
                                    <h4>クリア</h4>
                                    <p>あなたは7回の命を持って、自分の未来を守ることができました。画面を押すとタイトルに戻ります。</p>
                                </div>
                        </div>
                        <div class="wf-step">
                            <div class="step-content">
                                <span class="step-label">失敗</span>        
                            </div>
                            <div class="wf-popup">
                                <h4>失敗</h4>
                                <p>あなたの7回の命は、あなたの未来を救うには足りませんでした。リスタートすることができます</p>
                            </div>
                        </div>
                    </div>

                    <div class="wf-arrow"></div>

                    <div class="wf-branch">
                        <div class="wf-step">
                            <div class="step-content">
                                <span class="step-label">タイトル</span>
                                
                            </div>
                            <div class="wf-popup">
                                    <img src="../game/s7BeforeMe/starts1.png" alt="EASY,2x2x2blocks">
                                    <h4>タイトル</h4>
                                    <p>タイトル画面に戻ります。</p>
                                </div>
                        </div>
                        <div class="wf-step">
                            <div class="step-content">
                                <span class="step-label">リスタート</span>        
                            </div>
                            <div class="wf-popup">
                                <img src="../game/s7BeforeMe/games1.png" alt="NORMAL,3x3x3blocks">
                                <h4>リスタート</h4>
                                <p>前回のログを消去して、再び7回のデモプレイが始まります。</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <section class="next-project">
            <div class="next-project-inner">
                <span class="next-label">NEXT PROJECT</span>
                <a href="CubePuzzle.html" class="next-link">
                    <span class="next-title">CUBE PUZZLE</span>
                    <span class="next-category">Game</span>
                    <span class="next-arrow">→</span>
                </a>
            </div>
        </section>
    </main>

    <!-- フッター -->
    <footer class="site-footer">
        <a href="../pfrewafca.html" class="footer-home">← ホームへ戻る</a>
        <p class="footer-copy">© 2025 Rewaita Portfolio</p>
    </footer>


    <script>
        // 固定ナビゲーション表示制御
        document.addEventListener('DOMContentLoaded', () => {
            const nav = document.getElementById('fixedNav');
            const hamburger = document.getElementById('navHamburger');
            let lastScroll = 0;
            
            window.addEventListener('scroll', () => {
                const currentScroll = window.pageYOffset;
                if (currentScroll > 100) {
                    nav.classList.add('visible');
                    if (currentScroll > lastScroll && currentScroll > 300) {
                        nav.classList.add('hidden');
                    } else {
                        nav.classList.remove('hidden');
                    }
                } else {
                    nav.classList.remove('visible');
                }
                lastScroll = currentScroll;
            });

            // ハンバーガーメニュー
            hamburger.addEventListener('click', () => {
                nav.classList.toggle('menu-open');
            });
        });

        // ギャラリースライダー
        document.addEventListener('DOMContentLoaded', () => {
            const slides = document.querySelectorAll('.slider-container .slide');
            const totalSlides = slides.length;
            let currentIndex = 0;

            const leftButton = document.querySelector('.slider-container .leftB');
            const rightButton = document.querySelector('.slider-container .rightB');
            
            const config = {
                0: { z: 0, scale: 1.0, x: 0, opacity: 1.0, zIndex: 10 },
                1: { z: 250, scale: 1.1, x: 400, opacity: 0.25, zIndex: 12 },
                2: { z: 700, scale: 1.2, x: 700, opacity: 0.1, zIndex: 14 },
                "-1": { z: -350, scale: 0.9, x: -200, opacity: 0.9, zIndex: 8 },
                "-2": { z: -600, scale: 0.8, x: -350, opacity: 0.2, zIndex: 6 },
            };

            function updateSlider() {
                slides.forEach((slide, index) => {
                    let diff = index - currentIndex;
                    if (diff > totalSlides / 2) diff -= totalSlides;
                    else if (diff < -totalSlides / 2) diff += totalSlides;

                    const absDiff = Math.abs(diff);
                    if (absDiff <= 2) {
                        const style = config[diff.toString()];
                        slide.style.opacity = style.opacity;
                        slide.style.zIndex = style.zIndex;
                        slide.style.transform = `translateX(-50%) translateZ(${style.z}px) scale(${style.scale}) translateX(${style.x}px)`;
                        slide.style.pointerEvents = (diff === 0) ? 'auto' : 'none';
                    } else {
                        slide.style.opacity = 0;
                        slide.style.zIndex = 1;
                        slide.style.transform = `translateX(-100%) translateZ(-1000px) scale(0)`;
                        slide.style.pointerEvents = 'none';
                    }
                });
            }

            rightButton.addEventListener('click', () => {
                currentIndex = (currentIndex + 1) % totalSlides;
                updateSlider();
            });

            leftButton.addEventListener('click', () => {
                currentIndex = (currentIndex - 1 + totalSlides) % totalSlides;
                updateSlider();
            });

            // 画像クリックでポップアップ表示
            slides.forEach(slide => {
                slide.addEventListener('click', () => {
                    openPopup(slide.src, parseInt(slide.dataset.index));
                });
            });

            updateSlider();

            // ポップアップ機能
            const popup = document.getElementById('imagePopup');
            const popupImage = document.getElementById('popupImage');
            const popupClose = document.getElementById('popupClose');
            const popupPrev = document.getElementById('popupPrev');
            const popupNext = document.getElementById('popupNext');
            let popupIndex = 0;
            const slideSrcs = Array.from(slides).map(s => s.src);

            function openPopup(src, index) {
                popupIndex = index;
                popupImage.src = src;
                popup.classList.add('active');
                document.body.style.overflow = 'hidden';
            }

            function closePopup() {
                popup.classList.remove('active');
                document.body.style.overflow = '';
            }

            popupClose.addEventListener('click', closePopup);
            popup.addEventListener('click', (e) => {
                if (e.target === popup) closePopup();
            });

            popupPrev.addEventListener('click', (e) => {
                e.stopPropagation();
                popupIndex = (popupIndex - 1 + slideSrcs.length) % slideSrcs.length;
                popupImage.src = slideSrcs[popupIndex];
            });

            popupNext.addEventListener('click', (e) => {
                e.stopPropagation();
                popupIndex = (popupIndex + 1) % slideSrcs.length;
                popupImage.src = slideSrcs[popupIndex];
            });

            // キーボード操作
            document.addEventListener('keydown', (e) => {
                if (!popup.classList.contains('active')) return;
                if (e.key === 'Escape') closePopup();
                if (e.key === 'ArrowLeft') popupPrev.click();
                if (e.key === 'ArrowRight') popupNext.click();
            });
        });

        // ワークフロースライダー
        document.addEventListener('DOMContentLoaded', () => {
            const track = document.querySelector('.wf-track');
            const container = document.querySelector('.workflow-container');
            const branches = document.querySelectorAll('.wf-branch');

            function centerBranch(targetBranch) {
                if (!targetBranch) return;
                const containerWidth = container.offsetWidth;
                const branchCenter = targetBranch.offsetLeft + (targetBranch.offsetWidth / 2);
                
                let targetPosition;
                if (window.innerWidth <= 768) {
                    // 画面右端から20%の位置 = 左端から80%の位置
                    targetPosition = containerWidth * 0.8;
                } else {
                    // 通常は中央
                    targetPosition = containerWidth / 2;
                }
                
                const moveAmount = targetPosition - branchCenter - 40;
                track.style.transform = `translateX(${moveAmount}px)`;
            }

            branches.forEach(branch => {
                branch.addEventListener('click', () => centerBranch(branch));
            });

            // ウィンドウリサイズ時に再計算
            window.addEventListener('resize', () => {
                const activeBranch = document.querySelector('.wf-branch.active') || branches[0];
                centerBranch(activeBranch);
            });

            if (branches.length > 0) {
                requestAnimationFrame(() => centerBranch(branches[0]));
            }
        });
    </script>
</body>
</html>
